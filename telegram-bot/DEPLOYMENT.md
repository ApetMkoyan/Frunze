# Развертывание Telegram бота на Render

## Описание
Этот Telegram бот предназначен для управления парком аттракционов, включая учёт сотрудников, смен и автоматов (хоккей/боксёр).

## Требования
- Node.js 18.x или выше
- npm или yarn
- Telegram Bot Token

## Переменные окружения
Создайте файл `.env` в корне проекта со следующими переменными:

```env
# Telegram Bot Configuration
BOT_TOKEN=your_bot_token_here

# Security Settings
MAX_LOGIN_ATTEMPTS=3
SESSION_TIMEOUT=1800
ALLOWED_USERS=10

# Data Settings
DATA_FILE=./bot-data.json
BACKUP_INTERVAL=86400000

# Server Settings
PORT=3000
```

## Локальная разработка

1. Установите зависимости:
```bash
npm install
```

2. Создайте файл `.env` с вашими настройками

3. Запустите сервер:
```bash
npm start
```

## Развертывание на Render

1. Создайте новый Web Service на Render
2. Подключите ваш GitHub репозиторий
3. Настройте следующие параметры:
   - **Build Command**: `npm install`
   - **Start Command**: `npm start`
   - **Environment**: Node

4. Добавьте переменные окружения в настройках Render:
   - `BOT_TOKEN` - токен вашего Telegram бота
   - `PORT` - порт (обычно устанавливается автоматически)

## Структура проекта

```
telegram-bot/
├── server.js          # Основной сервер с HTTP и Telegram ботом
├── bot.js            # Базовая версия бота
├── bot-production.js # Продакшн версия бота
├── bot-secure.js     # Безопасная версия бота
├── config.js         # Конфигурация
├── package.json      # Зависимости и скрипты
├── Procfile          # Конфигурация для Render
└── bot-data.json     # Файл данных (создается автоматически)
```

## API Endpoints

После развертывания доступны следующие HTTP endpoints:

- `GET /` - Статус сервиса
- `GET /health` - Проверка здоровья сервиса
- `GET /status` - Детальная информация о состоянии бота

## Пользователи системы

### Администраторы
- `adminApet` (парк Фрунзе) - пароль: `1234`
- `adminNarek` (парк Морской Вокзал) - пароль: `4321`
- `adminXunk` (парк Нептун) - пароль: `9999`

### Менеджеры
- `manager1` (парк Фрунзе) - пароль: `5678`
- `manager2` (парк Фрунзе) - пароль: `8765`
- `managerMorVokzal` (парк Морской Вокзал) - пароль: `3333`
- `managerNeptun` (парк Нептун) - пароль: `4444`

### Супервайзеры
- `supervisor1` (парк Фрунзе) - пароль: `1111`
- `supervisor2` (парк Фрунзе) - пароль: `2222`

### Тестовые пользователи
- `testUser1` (парк Фрунзе) - пароль: `test1`
- `testUser2` (парк Фрунзе) - пароль: `test2`

## Функции бота

1. **Управление сотрудниками** - добавление, редактирование, удаление
2. **Управление сменами** - учёт рабочих смен с расчётом зарплат
3. **Управление автоматами** - учёт хоккейных и боксёрских автоматов
4. **Отчёты** - автоматические отчёты по всем данным
5. **Система ролей** - разные права доступа для разных пользователей
6. **Безопасность** - ограничение попыток входа, таймауты сессий

## Мониторинг

Бот автоматически:
- Создаёт резервные копии данных
- Логирует статус системы
- Очищает старые сессии
- Отслеживает использование ресурсов

## Поддержка

При возникновении проблем:
1. Проверьте логи в Render Dashboard
2. Убедитесь, что все переменные окружения установлены
3. Проверьте, что бот токен действителен
4. Убедитесь, что порт настроен правильно 